<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<!--
  What is jQuery?
  by adam j. sontag & Josh Kehn
  WTFPL License

  If you want the cool kid fonts for this preso:
  http://www.fontsquirrel.com/fontfacedemo/ChunkFive
  http://www.fontsquirrel.com/fontfacedemo/CartoGothic-Std

  This all refers to the Presentation slides or whatever.
  vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv

  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org
                 Brad Neuberg
-->
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge;chrome=1" />
    <title>Functions, OOP, and JSON</title>
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon" /> 
    
    <link href="css/fonts.css" rel="stylesheet" type="text/css" />
    <link href="css/main.css" rel="stylesheet" type="text/css" />
    <link href="css/syntax.css" rel="stylesheet" type="text/css" />
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/themes/ui-lightness/jquery-ui.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <div class="presentation">
      <div id="presentation-counter"></div>
      <div class="slides">
        <div class="slide" id="intro">
          <div class="bg">
            <section class="middle landing">
              <h1>Data Structures, JSON, and OOP</h1>
              <h4>Day 2</h4>
              <h4>by <code>collabraCode('js');</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h4>
            </section>
            </div>
        </div>

        <div class="slide">
          <header>
            <h1>Today&#39;s Agenda</h1>
          </header>
          <section class="text">
            <br/>
            <dl>
              <dt>Today&#39;s Objectives</dt>
              <dd>Understand the benefits and usage of Closures</dd>
              <dd>Read/Understand object-oriented JavaScript</dd>
              <dd>Write object-oriented JavaScript</dd>
              <dd>Present info from a JSON or JSONP backend</dd>
            </dl>
            <br/>
            <dl>
              <dt>Topics</dt>
              <dd>Data Structures</dd>
              <dd>JSON</dd>
              <dd>Functions/Closures</dd>
              <dd>OOP</dd>
              <dd>JS Callbacks and eval()</dd>
            </dl>
            <br/>
            <dl>
              <dt>Lab</dt>
              <dd>Pull headlines from an external source and display on your site</dd>
            </dl>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Data Structures</h1>
          </header>
          <section class="text">
            <br/>
            <dl>
              <dt>Array</dt>
              <dd>Access elements by arr[index] and have arr.length attribute</dd>
              <dd>Capable of a mix of array and list operations</dd>
              <dd>untyped, can contain anything in each element</dd>
            </dl>
            <dl>
              <dt>Object</dt>
              <dd>Key-Value pairs</dd>
              <dd>Keys are always strings</dd>
              <dd>Values can be of any type</dd>
            </dl>
            <dl>
              <dt>NodeList</dt>
              <dd>Immutable list with .length attribute and .item(index) function</dd>
            </dl>
            <dl>
              <dt>Element</dt>
              <dd>DOM Element contains child nodes</dd>
            </dl>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Data Structures &#8212; Array</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <p></p>
            <pre class="brush: js; toolbar: false;">
              var a = [210, 17, "alpha", 6.7, true, null, 42];
              var b = new Array();

              b.push("alpha");           // ["alpha"]
              b.push(5, false, "igloo"); // ["alpha", 5, false, "igloo"]
              b[0];                      // 5
              var c = b.pop();           // ["alpha", 5, false], c = "igloo"
              b.unshift("happy", "joy"); // ["happy", "joy", "alpha", 5, false]
              var d = b.shift();         // ["joy", "alpha", 5, false], d = "joy"
              b.reverse();               // [false, 5, "alpha", "joy"]
              b.sort();                  // [false, "alpha", "joy", 5]
              b.concat([63, 42]);        // [false, "alpha", "joy", 5, 63, 42]
              b.join(",");               // "false,alpha,joy,5,63,42"
            </pre>
            <br/>
            <div>
              More at <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array">https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array</a>
            </div>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Data Structures &#8212; Object</h1>
          </header>
          <section class="text muchSmallerCode">
            <p>Objects are a collection of key/value pairs where the keys are always strings</p>
            <p>Two ways to create/initialize objects</p>
            <dl>
              <dt>Explicit creation</dt>
              <dd>
                <pre class="brush: js; toolbar: false;">
                  var a = new Object();
                  // access or set property using dot notation
                  a.key = "value";
                  // access or set property using array notation
                  a["key2"] = new Object();
                  a["key2"].k = 123;
                  a["key2"]["u"] = 45;
                </pre>
              </dd>
              <dt>Object Notation</dt>
              <dd>
                <pre class="brush: js; toolbar: false;">
                  var a = {"key" : "value", "key2" : {"k" : 123, "u": 45} };
                  console.log(a.key);
                  console.log(a["key2"]);
                </pre>
              </dd>
            </dl>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Data Structures &#8212; Object iteration</h1>
          </header>
          <section class="text muchSmallerCode">
            <p>To iterate over the properties in an object you can use for(... in ...) syntax</p>
            <pre class="brush: js; toolbar: false;">
              for (var k in a) {
                if(a.hasOwnProperty(k)) {
                  /* access property of instance */
                } else {
                  /* access property of a type in the hierarchy */
                }
              }
            </pre>
            <br/>
            <dl>
              <dt>Caveat</dt>
              <dd>any prototype item will also be in a, so expect more than "key" and "key2"</dd>
            </dl>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Data Structures &#8212; NodeList</h1>
          </header>
          <section class="text muchSmallerCode">
            <p>
              Retrieved from DOM when looking for any list of elements
            </p>
            <pre class="brush: js; toolbar: false;">
              // Iterate
              var list = elem.childNodes;
              for (var i=0; i&lt;list.length; i++) {
                var node = list.item(i);
                // do stuff
              }
            </pre>
            <br/>
            <pre class="brush: js; toolbar: false;">
              // Slight optimization
              var list = elem.childNodes;
              for (var i=0, len=list.length; i&lt;len; i++) {
                ...
              }
            </pre>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Data Structures &#8212; Element</h1>
          </header>
          <section class="text">
            <br/>
            <dl>
              <dt>hasChildNodes()</dt>
              <dd>whether an element has child nodes</dd>
            </dl>
            <dl>
              <dt>childNodes</dt>
              <dd>Immutable list of child nodes</dd>
            </dl>
            <dl>
              <dt>appendChild(aNode)</dt>
              <dd>adds aNode to the end of childNodes</dd>
            </dl>
            <dl>
              <dt>insertChild(aNode, beforeNode)</dt>
              <dd>adds aNode as a child node before beforeNode</dd>
            </dl>
            <dl>
              <dt>removeChild(aNode)</dt>
              <dd>removes aNode from childNodes</dd>
            </dl>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>JS Callbacks and eval()</h1>
          </header>
          <section class="text muchSmallerCode">
            <p>
              Rather than return a document, return text that is a function being called with javascript elements as parameters.
            </p>
            <div>
              Literally returns text:
            </div>
            <pre class="brush: js; toolbar: false;">
              myCallback(123, "have some fun", [true, false, 1.0], null, "hi")
            </pre>
            <br/>
            <p>
              Normally you get to specify what function should be called in the query string of an HTTP request
            </p>
            <p>
              You can eval() the document, but be careful, anything could be in there...do you really trust the document?
            </p>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>JSON</h1>
          </header>
          <section class="text muchSmallerCode">
            <p>
              JavaScript Object Notation
            </p>
            <pre class="brush: js; toolbar: false;">
              {
                "key" : true, 
                "k" : 42.0, 
                "alpha" : ["beta", "zeta"], 
                "delta" : {
                  "greek" : "g\u1234m\r\na", 
                  "stuff" : null             // no comma at end
                }                            // no comma at end
              }
            </pre>
            <p>
              Supports: object, array, boolean, string, number, null
            </p>
            <p>
              That's it.
            </p>
            <p>
              <a href="http://json.org/">http://json.org/</a>
            </p>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>JSON &#8212; Why Use It?</h1>
          </header>
          <section class="text">
            <ul>
              <li>Faster, easier to parse and generate than XML</li>
              <li>Parsers/generators available in every language</li>
              <li>Smaller file transfers</li>
              <li>Use Content-Type application/json and most frameworks just work</li>
              <li>On client side, treat it as a Native Object, nothing special to do to use it</li>
              <li>Native Parser/Generator built-in to modern browsers</li>
            </ul>
          </section>
        </div>
        
        <div class="slide">
          <div class="bg">
            <section class="middle landing">
              <h1>JSON Validator</h1>
              <h3>Lab</h3>
            </section>
          </div>
        </div>
        
        <div class="slide">
          <div class="bg">
            <section class="middle landing">
              <h1>Pull headlines from Scripting News JSON River</h1>
              <h3>Lab</h3>
            </section>
          </div>
        </div>
		
        <div class="slide">
          <header>
            <h1>Functions</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <dl>
              <dt>Functions are a base type/first-class citizen</dt>
              <dd>passed around as arguments</dd>
              <dd>assignable to a variable</dd>
              <dd>can be elements in a data structure</dd>
            </dl>
            <br/>
            <dl>
              <dt>Functions can be redefined/overwritten at will</dt>
            </dl>
            <br/>
            <dl>
              <dt>Functions have their own scope</dt>
            </dl>
            <br/>
            <pre class="brush: js; toolbar: false;">
              function inc(accum) {
                var a = accum + 1;
                return a;
              }
              var a = inc;
            </pre>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Functions &#8212; Scopes/Closures</h1>
          </header>
          <br/>
          <section class="text muchSmallerCode">
            <pre class="brush: js; toolbar: false;">
              function add(num) {
                var a = function(elem) {
                  return elem + num;
                }
                return a;
              }
              
              var number = 5;
              var f = add(number);
              f(-1);               // -> 4
              f("8");              // -> "85"
              var arr = [1, 23, 17];
              arr.map(f);          // -> [6, 28, 22]
              arr;                 // -> [1, 23, 17]
              console.log(number); // -> "5"
            </pre>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Functions &#8212; First-Class Citizen</h1>
          </header>
          <br/>
          <section class="text muchSmallerCode">
            <pre class="brush: js; toolbar: false;">
              function accumulator(prev, current) {
                console.log(prev + ", " + current);
                return Number(prev) + Number(current);
              }
              
              var f = accumulator;
              var arr = [1, 23, 17];
              arr.reduce(f);       // -> 41
              // console outputs:
              // 1, 23
              // 24, 17
            </pre>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP &#8212; Why?</h1>
          </header>
          <section class="text">
            <br/>
            <dl>
              <dt>Abstraction</dt>
              <dd>know what something does, don't need to know how</dd>
            </dl>
            <dl>
              <dt>Encapsulation</dt>
              <dd>keep others from breaking your code</dd>
            </dl>
            <dl>
              <dt>Inheritance</dt>
              <dd>re-use existing code, type hierarchy</dd>
            </dl>
            <dl>
              <dt>Polymorphism</dt>
              <dd>override methods in inherited subclasses</dd>
            </dl>
            <dl>
              <dt>Decoupling</dt>
              <dd>Keep your object dependency graph split up</dd>
            </dl>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP Dependency Graph</h1>
          </header>
          <section class="image center">
            <br/>
            <img src="images/big_ball_of_yarn.jpg" height="540px"/>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Object Properties</h1>
          </header>
          <section class="image center middle">
            <img src="images/object_properties.png" width="800px"/>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Object Prototype Properties</h1>
          </header>
          <section class="image center middle">
            <img src="images/object_prototype_properties.png" width="800px"/>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP &#8212; Classes</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <pre class="brush: js; toolbar: false;">
              var A = function() {};
            </pre>
            <br/>
            <div class="center">
              <img src="images/oop_setup.png"/>
            </div>
            <!--
            <div class="center">
              <img src="https://chart.googleapis.com/chart?cht=gv&chs=500x300&chl=digraph{A->%22prototype%20{constructor:%20A}%22;}" width="500" height="300"/>
            </div>
            -->
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <pre class="brush: js; toolbar: false;">
              var A = function() {};
              var b = new A();
              var c = new A();
            </pre>
            <br/>
            <div class="center">
              <img src="images/oop_instances.png"/>
            </div>
            <!--
            <div class="center">
              <img src="https://chart.googleapis.com/chart?cht=gv&chs=500x300&chl=digraph{A->prototype;b->prototype;c->prototype;}" width="500" height="300"/>
            </div>
            -->
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP &#8212; Instance Values</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <pre class="brush: js; toolbar: false;">
              var A = function(value) {
                this.value = value;
              };
              var b = new A(42);
              var c = new A("blah");
            </pre>
            <br/>
            <div class="center">
              <img src="images/oop_instance_variables.png"/>
            </div>
            <!--
            <div class="center">
              <img src="https://chart.googleapis.com/chart?cht=gv&chs=800x300&chl=digraph{A->prototype;%22b%20{value:%2042}%22->prototype;%22c%20{value:%20blah}%22->prototype;}" width="800" height="300"/>
            </div>
            -->
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP &#8212; Excessive Memory</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <pre class="brush: js; toolbar: false;">
              var A = function(value) {
                this.value = value;
                this.draw = function() {};
              };
              var b = new A(42);
              var c = new A("blah");
            </pre>
            <div class="center">
              <img src="images/oop_excessive_memory.png"/>
            </div>
            <!--
            <div class="center">
              <img src="https://chart.googleapis.com/chart?cht=gv&chs=800x200&chl=digraph{A->prototype;%22b%20{value:%2042,%20draw:%20function()}%22->prototype;%22c%20{value:%20blah,%20draw:%20function()}%22->prototype;}" width="800" height="200"/>
            </div>
            -->
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP &#8212; Single Implementation</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <pre class="brush: js; toolbar: false;">
              var A = function(value) { this.value = value; };
              var b = new A(42);
              var c = new A("blah");
              A.prototype.draw = function() {};
            </pre>
            <br/>
            <div class="center">
              <img src="images/oop_single_implementation.png"/>
            </div>
            <!--
            <div class="center">
              <img src="https://chart.googleapis.com/chart?cht=gv&chs=800x350&chl=digraph{A->%22prototype%20{draw:%20function()}%22;%22b%20{value:%2042}%22->%22prototype%20{draw:%20function()}%22;%22c%20{value:%20blah}%22->%22prototype%20{draw:%20function()}%22;}" width="800" height="350"/>
            </div>
            -->
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP &#8212; New Base</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <pre class="brush: js; toolbar: false;">
              var A = function(value) { this.value = value; };
              A.prototype.draw = function() {};
              var b = new A(42);
              var c = new A("blah");
              c.y = 2;
              A.prototype = {"v": 1};
              var d = new A(7);
            </pre>
            <div class="center">
              <img src="images/oop_new_base_class.png"/>
            </div>
            <!--
            <div class="center">
              <img src="https://chart.googleapis.com/chart?cht=gv&chs=800x200&chl=digraph{%22b%20{value:%2042,%20y:%202}%22->%22prototype%20{draw:%20function()}%22;%22c%20{value:%20blah}%22->%22prototype%20{draw:%20function()}%22;A->%22prototype%20{v%20:%201}%22}" width="800" height="200"/>
            </div>
            -->
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP &#8212; Class/Instance Functions</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <pre class="brush: js; toolbar: false;">
              b.__proto__.hasOwnProperty("constructor") // true
              "constructor" in c                        // true
              for (var i in b.__proto__) alert(i);      // draw
              c.constructor    // function (value) { this.value = value; }
              c instanceof A   // false
              d instanceof A   // true
              d.constructor    // function Object() { [native code] }
            </pre>
            <div class="center">
              <img src="images/oop_new_base_class.png"/>
            </div>
            <!--
            <div class="center">
              <img src="https://chart.googleapis.com/chart?cht=gv&chs=800x200&chl=digraph{%22b%20{value:%2042,%20y:%202}%22->%22prototype%20{draw:%20function()}%22;%22c%20{value:%20blah}%22->%22prototype%20{draw:%20function()}%22;A->%22prototype%20{v%20:%201}%22}" width="800" height="200"/>
            </div>
            -->
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP &#8212; Example</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <pre class="brush: js; toolbar: false;">
              var Calculator = function(a, b) {
                  this.a = Number(a);  // always ensure inputs are the right types
                  this.b = Number(b);  // best to ensure before storing in a class
              };

              Calculator.prototype.add  = function() { return this.a + this.b; };
              Calculator.prototype.sub  = function() { return this.a - this.b; };
              Calculator.prototype.mult = function() { return this.a * this.b; };
              Calculator.prototype.div  = function() { return this.a / this.b; };

              var calc = new Calculator("7", 6); // -> new instance
              var ultimateAnswer = calc.mult();  // -> 42
              var unlucky = calc.add();          // -> 13
            </pre>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>OOP &#8212; Prototype Inheritance</h1>
          </header>
          <section class="text muchSmallerCode">
            <br/>
            <pre class="brush: js; toolbar: false;">
              var AdvCalculator = function(a, b) {
                  this.a = Number(a);
                  this.b = Number(b);
              };
              
              AdvCalculator.prototype = new Calculator();
              AdvCalculator.prototype.constructor = AdvCalculator;
              AdvCalculator.prototype.logn = function() {
                  return Math.log(this.a) / Math.log(this.b);
              };
              
              AdvCalculator.prototype.pow = function() {
                  return Math.pow(this.a, this.b);
              };
              
              var calc = new AdvCalculator("7", 6); // -> new instance
              var ultimateAnswer = calc.mult();     // -> 42
              var largeNumber = calc.pow();         // -> 117649
            </pre>
          </section>
        </div>
        
        <div class="slide">
          <div class="bg">
            <section class="middle landing">
              <h1>Shopping Cart Item OOP</h1>
              <h3>Lab</h3>
            </section>
          </div>
        </div>
        
        <div class="slide">
          <header>
            <h1>Requirements</h1>
          </header>
          <section class="text">
            <br/>
            <p>Shopping Cart must support wide variety of items</p>
            <ul>
              <li>Name and plot some items</li>
              <li>Ask for relationships between items</li>
              <li>Get audience to come up with Class Diagram</li>
              <li>Implement class diagram in JavaScript</li>
            </ul>
          </section>
        </div>
        
        <div class="slide">
          <header>
            <h1>Requirements</h1>
          </header>
          <section class="image middle center">
            <br/>
            <img src="https://chart.googleapis.com/chart?cht=gv&chs=700x400&chl=graph{item--electronic;item--physical--sized--apparel--shirt;item--nonitem--donation;physical--nonsized--mug;nonsized--watches;nonsized--stickers;apparel--pants;apparel--shoes;apparel--belt;apparel--coat;nonsized--%22ipad%20cover%22}" width="700" height="400"/>
          </section>
        </div>
        
        <div class="slide">
          <div class="bg">
            <section class="middle landing">
              <h1>Shopping Cart Item OOP</h1>
              <h3>Lab</h3>
            </section>
          </div>
        </div>
        
      <!-- slides -->

    </div> <!-- presentation -->
    <!--[if lt IE 9]>
    <script
    src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">
    </script>
    <script>CFInstall.check({ mode: "overlay" });</script>
    <![endif]-->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
    <script type="text/javascript" src="js/slideshow.js"></script>
    <script type="text/javascript">
      function getInnerText(elem) {
        if(typeof elem.innerText == "undefined") {
          return elem.textContent;
        }
        return elem.innerText;
      }
      function setInnerText(elem, value) {
        if(typeof elem.innerText == "undefined") {
          elem.textContent = value;
        } else {
          elem.innerText = value;
        }
      }
      function stringify(value) {
        if(typeof value == "string") {
          return "\"" + value + "\"";
        }
        if(typeof value == "object") {
          return JSON.stringify(value);
        }
        return String(value);
      }
    </script>
  </body>
</html>
